summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .01, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .1, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 2) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 2, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
summary(m1)
summary(m2)
m1
AIC(m1)
AIC(m2)
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 1.5, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 1.5, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
scale_color_manual(name = 'Model', labels = c(linear = 'Linear', powerfun = 'Power')) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw() +
theme(legend.position = c(.1,.8))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 1.5, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
scale_color_discrete(name = 'Model', labels = c(linear = 'Linear', powerfun = 'Power')) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw() +
theme(legend.position = c(.1,.8))
m2$m$getPars()
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
d <- d[d$transition != 'startBlock',]
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
d <- d[d$transition != 'startBlock',]
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
newdata <- expand.grid(chosenDeckIdEI = seq(.1, .9, .001), transition = c('repeat', 'switch'))
newdata$proba <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI + m1$coefficients[3] * newdata$transition + m1$coefficients[4] * newdata$transition * newdata$chosenDeckIdEI
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEi, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d <- d[d$transition != 'startBlock',]
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
newdata <- expand.grid(chosenDeckIdEI = seq(.1, .9, .001), transition = c(0, 1))
newdata$proba <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI + m1$coefficients[3] * newdata$transition + m1$coefficients[4] * newdata$transition * newdata$chosenDeckIdEI
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEi, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3) +
#geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
head(newdata)
tail(newdata)
d <- d[d$transition != 'startBlock',]
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
newdata <- expand.grid(chosenDeckIdEI = seq(.1, .9, .001), transition = c(0, 1))
newdata$proba <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI + m1$coefficients[3] * newdata$transition + m1$coefficients[4] * newdata$transition * newdata$chosenDeckIdEI
class(d$chosenDeckIdEI)
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3)
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(rt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.1, height = 0, alpha = 0.3)
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.1, height = 0, alpha = 0.3)
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
#scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.1, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.1, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) #+
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.1, height = 0, alpha = 0.3)  #+
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.01, height = 0, alpha = 0.3)  #+
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  #+
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) #+
class(newdata$chosenDeckIdEI)
typeof(newdata$chosenDeckIdEI)
class(d$chosenDeckIdEI)
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba), size = 2) #+
newdata$transition <- ifelse(newdata$transition == 0, 'repeat', 'switch')
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) #+
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2))
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
scale_color_manual(name = 'Transition', labels = c(`repeat` = 'Repeat', `switch`='Switch'), values = c(`repeat` = 'blue', `switch` = 'red')) +
theme_bw() +
theme(legend.position = c(.1,.8))
d$chosenDeckIdEI <- as.double(as.character(d$chosenDeckIdEI))
d$chosenDeckIdEI <- d$chosenDeckIdEI - 0.5
m1 <- lm(cuedRt ~ chosenDeckIdEI, data = d)
newdata <- data.frame(chosenDeckIdEI = seq(0.1,0.9, .001))
newdata$linear <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI
sm <- d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(cuedRt = mean(cuedRt))
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 500, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1500, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 2000, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 5000, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 500, b = 1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 500, b = .1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 10000, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 800, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 300, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 70, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 50, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 40, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 20, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = .2, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = .2), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = .1), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 0), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 10), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 100), trace=T)
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 1000), trace=T)
library(tidyverse)
d <- read.csv('../../../data/dstClean.csv')
N <- d %>%
group_by(subject) %>%
summarize(n()) %>%
nrow()
head(d)
condCodes <- data.frame(chosenDeckId = unique(d$chosenDeckId), chosenDeckIdEI = c(.1,.5,.3,.9,.7))
d <- d %>%
inner_join(condCodes, by = 'chosenDeckId') %>%
mutate(chosenDeckIdEI = factor(chosenDeckIdEI))
cm <- d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(mrt = mean(cuedRt)) %>%
group_by(chosenDeckIdEI) %>%
summarize(rt = mean(mrt), se = sd(mrt) / sqrt(N))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.2) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .5) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d$chosenDeckIdEI <- as.double(as.character(d$chosenDeckIdEI))
m1 <- lm(cuedRt ~ chosenDeckIdEI, data = d)
newdata <- data.frame(chosenDeckIdEI = seq(0.1,0.9, .001))
newdata$linear <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI
sm <- d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(cuedRt = mean(cuedRt))
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 1), trace=T)
newdata$powerfun <- m2$m$getPars()['a'] * newdata$chosenDeckIdEI^m2$m$getPars()['b']
newdata <- newdata %>%
gather(model, proba, linear, powerfun)
cm$chosenDeckIdEI <- as.numeric(as.character(cm$chosenDeckIdEI))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 1.5, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
scale_color_discrete(name = 'Model', labels = c(linear = 'Linear', powerfun = 'Power')) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw() +
theme(legend.position = c(.1,.8))
d <- d[d$transition != 'startBlock',]
d$chosenDeckIdEI = d$chosenDeckIdEI - 0.5
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
newdata <- expand.grid(chosenDeckIdEI = seq(.1, .9, .001), transition = c(0, 1))
newdata$chosenDeckIdEI <- newdata$chosenDeckIdEI - 0.5
newdata$proba <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI + m1$coefficients[3] * newdata$transition + m1$coefficients[4] * newdata$transition * newdata$chosenDeckIdEI
newdata$transition <- ifelse(newdata$transition == 0, 'repeat', 'switch')
newdata$chosenDeckIdEI <- newdata$chosenDeckIdEI + 0.5
d$chosenDeckIdEI <- d$chosenDeckIdEI + 0.5
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
scale_color_manual(name = 'Transition', labels = c(`repeat` = 'Repeat', `switch`='Switch'), values = c(`repeat` = 'blue', `switch` = 'red')) +
theme_bw() +
theme(legend.position = c(.1,.8))
summary(d$chosenDeckIdEI)
d$chosenDeckIdEI_c = d$chosenDeckIdEI - 0.1
m1 <- lm(cuedRt ~ chosenDeckIdEI_c * transition, data = d)
summary(m1)
d$chosenDeckIdEI_c = d$chosenDeckIdEI - 0.9
m1 <- lm(cuedRt ~ chosenDeckIdEI_c * transition, data = d)
summary(m1)
q()
library(tidyverse)
d <- read.csv('../../../data/dstClean.csv')
N <- d %>%
group_by(subject) %>%
summarize(n()) %>%
nrow()
head(d)
condCodes <- data.frame(chosenDeckId = unique(d$chosenDeckId), chosenDeckIdEI = c(.1,.5,.3,.9,.7))
d <- d %>%
inner_join(condCodes, by = 'chosenDeckId') %>%
mutate(chosenDeckIdEI = factor(chosenDeckIdEI))
cm <- d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(mrt = mean(cuedRt)) %>%
group_by(chosenDeckIdEI) %>%
summarize(rt = mean(mrt), se = sd(mrt) / sqrt(N))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.2) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .5) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw()
d$chosenDeckIdEI <- as.double(as.character(d$chosenDeckIdEI))
m1 <- lm(cuedRt ~ chosenDeckIdEI, data = d)
newdata <- data.frame(chosenDeckIdEI = seq(0.1,0.9, .001))
newdata$linear <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI
sm <- d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(cuedRt = mean(cuedRt))
m2 <- nls(cuedRt ~ a * I(chosenDeckIdEI^b), data = d, start = list(a = 1000, b = 1), trace=T)
newdata$powerfun <- m2$m$getPars()['a'] * newdata$chosenDeckIdEI^m2$m$getPars()['b']
newdata <- newdata %>%
gather(model, proba, linear, powerfun)
cm$chosenDeckIdEI <- as.numeric(as.character(cm$chosenDeckIdEI))
d %>%
group_by(subject, chosenDeckIdEI) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt)) +
geom_jitter(height = 0, alpha = .3, width = 0.01) +
geom_line(data = cm, aes(x = chosenDeckIdEI, y = rt, group = 1)) +
geom_point(data = cm, aes(x = chosenDeckIdEI, y = rt), size = 2) +
geom_errorbar(data = cm, aes(ymin = rt - se, ymax = rt + se), width = .05) +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = model, group = model), size = 1.5, linetype = 'dashed') +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
scale_color_discrete(name = 'Model', labels = c(linear = 'Linear', powerfun = 'Power')) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
theme_bw() +
theme(legend.position = c(.1,.8))
summary(m1)
summary(m2)
d <- d[d$transition != 'startBlock',]
d$chosenDeckIdEI = d$chosenDeckIdEI - 0.5
d$transitionE <- ifelse(d$transition == 'repeat', -0.5, 0.5)
m1 <- lm(cuedRt ~ chosenDeckIdEI * transition, data = d)
summary(m1)
newdata <- expand.grid(chosenDeckIdEI = seq(.1, .9, .001), transition = c(-0.5, 0.5))
newdata$chosenDeckIdEI <- newdata$chosenDeckIdEI - 0.5
newdata$proba <- m1$coefficients[1] + m1$coefficients[2] * newdata$chosenDeckIdEI + m1$coefficients[3] * newdata$transition + m1$coefficients[4] * newdata$transition * newdata$chosenDeckIdEI
newdata$transition <- ifelse(newdata$transition == -0.5, 'repeat', 'switch')
newdata$chosenDeckIdEI <- newdata$chosenDeckIdEI + 0.5
d$chosenDeckIdEI <- d$chosenDeckIdEI + 0.5
d %>%
group_by(subject, chosenDeckIdEI, transition) %>%
summarize(rt = mean(cuedRt)) %>%
ggplot(aes(x = chosenDeckIdEI, y = rt, group = transition)) +
geom_jitter(aes(color = transition), width = 0.02, height = 0, alpha = 0.3)  +
geom_line(data = newdata, aes(x = chosenDeckIdEI, y = proba, color = transition), size = 2) +
scale_x_continuous(breaks = seq(.1,.9,.2), labels = seq(.1,.9,.2)) +
labs(
x = 'Chosen Deck Probability of Switching',
y = 'Response Time (ms)'
) +
scale_color_manual(name = 'Transition', labels = c(`repeat` = 'Repeat', `switch`='Switch'), values = c(`repeat` = 'blue', `switch` = 'red')) +
theme_bw() +
theme(legend.position = c(.1,.8))
q()
